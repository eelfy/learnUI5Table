<!DOCTYPE html>
<html>
<head>
	<meta http-equiv='X-UA-Compatible' content='IE=edge'>
	<meta charset="utf-8">
	<title>SmartFilterBar Accesibility Test Page</title>

	<script id='sap-ui-bootstrap'
		type="text/javascript"
		src="../../../../../../resources/sap-ui-core.js"
		data-sap-ui-theme='sap_fiori_3'
		data-sap-ui-libs='sap.m, sap.ui.comp'
		data-sap-ui-resourceroots='{
			"qunit.internal.acc": "../../../../test-resources/sap/ui/core/qunit/internal/acc"
		}'
		data-sap-ui-compatVersion='edge'
	></script>

	<script id="mainView" type="text/xml">
		<core:View xmlns="sap.m"
		xmlns:core="sap.ui.core"
		xmlns:smartFilterBar="sap.ui.comp.smartfilterbar"
		xmlns:smartvariants="sap.ui.comp.smartvariants"
		xmlns:smartTable="sap.ui.comp.smarttable"
		xmlns:customData="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1"
		controllerName="mainView.controller" height="100%">
		<App>
			<Page showHeader="false">
				<smartvariants:SmartVariantManagement
					id="variantManagement"
					persistencyKey="StandardPersistencyKey"
					showShare="true"
					entitySet="CompanyItemsSet"
					showExecuteOnSelection="true"/>

				<smartFilterBar:SmartFilterBar
					id="smartFilterBar"
					entitySet="CompanyItemsSet"
					considerSelectionVariants="false"
					deltaVariantMode="true"
					filterChange="onFilterChange"
					persistencyKey="UniqueAndStablePersistencyKey"
					smartVariant="variantManagement"
					enableBasicSearch="true"
					basicSearchFieldName="CompanyCode">
						<smartFilterBar:controlConfiguration>
							<smartFilterBar:ControlConfiguration
									key="CompanyName"
									visibleInAdvancedArea="true">
							</smartFilterBar:ControlConfiguration>
							<smartFilterBar:ControlConfiguration
									key="Email"
									visibleInAdvancedArea="true">
							</smartFilterBar:ControlConfiguration>
							<smartFilterBar:ControlConfiguration
									key="CompanyCode"
									visibleInAdvancedArea="true">
							</smartFilterBar:ControlConfiguration>
							<smartFilterBar:ControlConfiguration
									key="Street"
									visibleInAdvancedArea="true">
							</smartFilterBar:ControlConfiguration>
							<smartFilterBar:ControlConfiguration
									key="Country"
									visibleInAdvancedArea="true">
							</smartFilterBar:ControlConfiguration>
						</smartFilterBar:controlConfiguration>
				</smartFilterBar:SmartFilterBar>

				<smartTable:SmartTable
					id="smartTable"
					entitySet="CompanyItemsSet"
					smartFilterId="smartFilterBar"
					tableType="Table"
					enableAutoBinding="true"
					useVariantManagement="true"
					useTablePersonalisation="true"
					header="Company Items"
					showRowCount="true"
					initiallyVisibleFields="CompanyCode,CompanyName,Email,Street,Country">
						<smartTable:layoutData>
							<FlexItemData growFactor="1"/>
						</smartTable:layoutData>
				</smartTable:SmartTable>

			</Page>
		</App>
		</core:View>
		</script>
		<script id="dataSection" type="text/json">
			{"d": {
				"__count": "2",
				"results": [
				{
					"__metadata": {
						"uri": "testService.CompanyItemsSet/CompanyItemsSet('0001')",
						"type": "AccessibilityNamespace.CompanyItemsSet"
					},
					"CompanyCode": "0001",
					"CompanyName": "SAP SE",
					"Email": "gatesfernandez@quintity.com",
					"Phone": "+1 (826) 451-3236",
					"Street": "River Street 835",
					"City": "Veguita",
					"Country": "Cocos (Keeling Islands)",
					"CurrencyCode": "EUR",
					"BoolCode": true
				}, {
					"__metadata": {
						"uri": "testService.CompanyItemsSet/CompanyItemsSet('0002')",
						"type": "AccessibilityNamespace.CompanyItemsSet"
					},
					"CompanyCode": "0002",
					"CompanyName": "SAP Labs India",
					"Email": "gatesfernandez@zoarere.com",
					"Phone": "+1 (990) 516-2987",
					"Street": "Woodhull Street 740",
					"City": "Babb",
					"Country": "Western Sahara",
					"CurrencyCode": "JPY",
					"BoolCode": false
				},
				{
					"__metadata": {
						"uri": "testService.CompanyItemsSet/CompanyItemsSet('0003')",
						"type": "AccessibilityNamespace.CompanyItemsSet"
					},
					"CompanyCode": "0003",
					"CompanyName": "ANDRYX",
					"Email": "gatesfernandez@andryx.com",
					"Phone": "+1 (877) 584-3223",
					"Street": "Kingston Avenue 234",
					"City": "Tyhee",
					"Country": "Indonesia",
					"CurrencyCode": "JPY",
					"BoolCode": true
				}, {
					"__metadata": {
						"uri": "testService.CompanyItemsSet/CompanyItemsSet('0004')",
						"type": "AccessibilityNamespace.CompanyItemsSet"
					},
					"CompanyCode": "0004",
					"CompanyName": "NAXDIS",
					"Email": "gatesfernandez@naxdis.com",
					"Phone": "+1 (844) 406-3829",
					"Street": "Kenmore Terrace 352",
					"City": "Weogufka",
					"Country": "Lebanon",
					"CurrencyCode": "EUR",
					"BoolCode": true
				}, {
					"__metadata": {
						"uri": "testService.CompanyItemsSet/CompanyItemsSet('0005')",
						"type": "AccessibilityNamespace.CompanyItemsSet"
					},
					"CompanyCode": "0005",
					"CompanyName": "ZILODYNE",
					"Email": "gatesfernandez@zilodyne.com",
					"Phone": "+1 (963) 499-2190",
					"Street": "Conover Street 963",
					"City": "Graball",
					"Country": "Sudan",
					"CurrencyCode": "JPY",
					"BoolCode": true
				}, {
					"__metadata": {
						"uri": "testService.CompanyItemsSet/CompanyItemsSet('0006')",
						"type": "AccessibilityNamespace.CompanyItemsSet"
					},
					"CompanyCode": "0006",
					"CompanyName": "OPTICON",
					"Email": "gatesfernandez@opticon.com",
					"Phone": "+1 (974) 428-2229",
					"Street": "Hicks Street 491",
					"City": "Wauhillau",
					"Country": "Macau",
					"CurrencyCode": "USD",
					"BoolCode": false
				}, {
					"__metadata": {
						"uri": "testService.CompanyItemsSet/CompanyItemsSet('0007')",
						"type": "AccessibilityNamespace.CompanyItemsSet"
					},
					"CompanyCode": "0007",
					"CompanyName": "EXOPLODE",
					"Email": "gatesfernandez@exoplode.com",
					"Phone": "+1 (960) 526-2398",
					"Street": "Caton Avenue 854",
					"City": "Barstow",
					"Country": "Zambia",
					"CurrencyCode": "EUR",
					"BoolCode": false
				}, {
					"__metadata": {
						"uri": "testService.CompanyItemsSet/CompanyItemsSet('0008')",
						"type": "AccessibilityNamespace.CompanyItemsSet"
					},
					"CompanyCode": "0008",
					"CompanyName": "SENSATE",
					"Email": "gatesfernandez@sensate.com",
					"Phone": "+1 (987) 524-2004",
					"Street": "Varick Avenue 832",
					"City": "Hatteras",
					"Country": "Tanzania",
					"CurrencyCode": "USD",
					"BoolCode": false
				}, {
					"__metadata": {
						"uri": "testService.CompanyItemsSet/CompanyItemsSet('0009')",
						"type": "AccessibilityNamespace.CompanyItemsSet"
					},
					"CompanyCode": "0009",
					"CompanyName": "MICROLUXE",
					"Email": "gatesfernandez@microluxe.com",
					"Phone": "+1 (831) 497-3795",
					"Street": "Elizabeth Place 171",
					"City": "Nipinnawasee",
					"Country": "Dominican Republic",
					"CurrencyCode": "JPY",
					"BoolCode": true
				}, {
					"__metadata": {
						"uri": "testService.CompanyItemsSet/CompanyItemsSet('0010')",
						"type": "AccessibilityNamespace.CompanyItemsSet"
					},
					"CompanyCode": "0010",
					"CompanyName": "FLUMBO",
					"Email": "gatesfernandez@flumbo.com",
					"Phone": "+1 (939) 428-2762",
					"Street": "Madison Place 334",
					"City": "Neahkahnie",
					"Country": "Cook Islands",
					"CurrencyCode": "USD",
					"BoolCode": true
				}
			]
			}}
		</script>
		<script id="metadata" type="text/xml"><?xml version="1.0" encoding="utf-8"?>
			<edmx:Edmx xmlns:edmx="http://schemas.microsoft.com/ado/2007/06/edmx"
					   xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata"
					   xmlns:sap="http://www.sap.com/Protocols/SAPData" Version="1.0">

				<edmx:DataServices m:DataServiceVersion="2.0">
					<Schema xmlns="http://schemas.microsoft.com/ado/2008/09/edm"
							Namespace="AccessibilityNamespace"
							xml:lang="en"
							sap:schema-version="1">

							<EntityType Name="CompanyItemsType" sap:label="Company Item" sap:semantics="aggregate" sap:content-version="1">
								<Key>
									<PropertyRef Name="CompanyCode" />
								</Key>
								<Property Name="CompanyCode" Type="Edm.String" Nullable="false"
								MaxLength="4" sap:display-format="UpperCase" sap:label="Company Code" />
								<Property Name="CompanyName" Type="Edm.String" Nullable="false"
								MaxLength="256" sap:display-format="UpperCase" sap:label="Company Name" />
								<Property Name="Email" Type="Edm.String" sap:label="Email" sap:creatable="false"
								sap:quickinfo="Property annotation IsEmailAddress" sap:updatable="true" sap:sortable="false" />
								<Property Name="Phone" Type="Edm.String" Nullable="true" sap:label="Phone" sap:creatable="false"
								sap:quickinfo="Property contains a phone number" sap:updatable="true" sap:sortable="false" />
								<Property Name="Street" Type="Edm.String" Nullable="false"
								MaxLength="256" sap:display-format="UpperCase" sap:label="Street" />
								<Property Name="City" Type="Edm.String" Nullable="false"
								MaxLength="256" sap:display-format="UpperCase" sap:label="City" />
								<Property Name="Country" Type="Edm.String" Nullable="false"
								MaxLength="256" sap:display-format="UpperCase" sap:label="Country" />
								<Property Name="CurrencyCode" Type="Edm.String" sap:label="Currency Code" sap:updatable="true"/>
								<Property Name="BoolCode" Type="Edm.Boolean" sap:label="Wifi"/>
							</EntityType>

							<EntityContainer Name="AccessibilityNamespace_Entities"
							m:IsDefaultEntityContainer="true"
							sap:supported-formats="atom json xlsx">

						<EntitySet Name="CompanyItemsSet"
									EntityType="AccessibilityNamespace.CompanyItemsType"
									sap:creatable="false"
									sap:updatable="true"
									sap:deletable="true"
									sap:content-version="1"/>


					</EntityContainer>
							<Annotations Target="AccessibilityNamespace.Types/Phone" xmlns="http://docs.oasis-open.org/odata/ns/edm">
								<Annotation Term="com.sap.vocabularies.Communication.v1.IsPhoneNumber" Bool="true" />
							</Annotations>
							<Annotations Target="AccessibilityNamespace.Types/Email" xmlns="http://docs.oasis-open.org/odata/ns/edm">
								<Annotation Term="com.sap.vocabularies.Communication.v1.IsEmailAddress" Bool="true" />
							</Annotations>
					</Schema>
				</edmx:DataServices>
			</edmx:Edmx>
		</script>
		<script>
			sap.ui.getCore().attachInit(function () {

				var ODataModel = sap.ui.requireSync("sap/ui/model/odata/v2/ODataModel"),
					MockServer = sap.ui.requireSync("sap/ui/core/util/MockServer"),
					ODataUtils = sap.ui.requireSync("sap/ui/model/odata/ODataUtils");
					FakeLrepConnectorLocalStorage = sap.ui.requireSync("sap/ui/fl/FakeLrepConnectorLocalStorage");

				FakeLrepConnectorLocalStorage.enableFakeConnector();

				/** Controller **/
				sap.ui.controller("mainView.controller", {
						oSmartFilterBar: null,
					onInit: function() {
						var sServiceName = "";

						setupMockServer(sServiceName);

						var oModel = new ODataModel(sServiceName +"/", {
							useBatch: false,
							defaultBindingMode: "TwoWay"
						});

						this.getView().setModel(oModel);

						this.oSmartFilterBar = this.getView().byId("smartFilterBar");
					},
					onExit: function () {
						this._oMockServer.stop();
					}
				});

				/** Component **/
				jQuery.sap.declare("mainView.Component");
				sap.ui.core.UIComponent.extend("mainView.Component", {
					createContent: function() {
						var oApp = new sap.m.App({
							initialPage: "idView"
						});
						oApp.addPage(sap.ui.xmlview("idView", { viewContent: jQuery("#mainView").html() }));
						return oApp;
					}
				});
				new sap.ui.core.ComponentContainer({
					name : "mainView"
				}).placeAt("content");

				/** MockServer **/
				function setupMockServer(service) {
					var sBasePath = service,
						oMockServer,
						aReqList;


					oMockServer = new MockServer({
						rootUri: sBasePath
					});

					aReqList = oMockServer.getRequests();

					// $metadata
					aReqList.push({
						method: 'GET',
						path: '/\\$metadata(.*)',
						response: function(req, resp) {
							req.respondXML(200, {}, jQuery("#metadata").html());
						}
					});

					// Data
					aReqList.push({
						method: 'GET',
						path: '/\\CompanyItemsSet(.*)',
						response: function(req, resp) {
							req.respondJSON(200, {}, jQuery("#dataSection").html());
						}
					});
					oMockServer.setRequests(aReqList);
					oMockServer.simulate(sBasePath + '/$metadata',
						{
							sMockdataBaseUrl: sBasePath + '/',
							bGenerateMissingMockData: true
						});
					oMockServer.start();
				}
			});
		</script>

</head>

<body id='content' class='sapUiBody'>
</body>

</html>