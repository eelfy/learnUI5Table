//@ui5-bundle sap/ushell/demo/AppPersSample/Component-preload.js
// Copyright (c) 2009-2020 SAP SE, All Rights Reserved
sap.ui.predefine('sap/ushell/demo/AppPersSample/App.controller',["sap/m/MessageToast","sap/base/Log"],function(M,L){"use strict";sap.ui.controller("sap.ushell.demo.AppPersSample.App",{onInit:function(){var t=this;var i={container:"sap.ushell.demo.FruitFavorites",item:"favorites"};this.oPersonalizationPromise=this.getOwnerComponent().getService("Personalization").then(function(p){var P,c;c=p.constants;P=p.getPersonalizer(i,{keyCategory:c.keyCategory.FIXED_KEY,writeFrequency:c.writeFrequency.LOW,clientStorageAllowed:true},t.getMyComponent());return{personalizer:P,constants:c,service:p};},function(e){throw new Error("Cannot get Personalization service: "+e);});this.applyExistingFruitFavorites(i);this.initIceCreamFavorites();this.initMilkshakeFavorites();},getMyComponent:function(){var c=sap.ui.core.Component.getOwnerIdFor(this.getView());return sap.ui.component(c);},initIceCreamFavorites:function(){var t=this;this.oPersonalizationPromise.then(function(p){var c;c=p.constants;t.getView().byId("btnSaveIceCream").setEnabled(false);p.service.getContainer("sap.ushell.IceCreamFavorites",{validity:2,keyCategory:c.keyCategory.FIXED_KEY,writeFrequency:c.writeFrequency.LOW,clientStorageAllowed:false},t.getMyComponent()).done(function(C){var i,P=t.getView()&&t.getView().byId("PanelIceCreamFavorites")&&t.getView().byId("PanelIceCreamFavorites").getContent();if(!P){L.error("View or control PanelIceCreamFavorites no longer present");return;}t.oIceCreamContainer=C;for(i=0;i<P.length;i=i+1){if(P[i]instanceof sap.m.CheckBox){P[i].setSelected(t.oIceCreamContainer.getItemValue(String(i))||false);}}t.getView().byId("btnSaveIceCream").setEnabled(true);});});},initMilkshakeFavorites:function(){var t=this;this.oPersonalizationPromise.then(function(p){var i,P=t.getView().byId("PanelMilkshakeFavorites").getContent(),c;c=p.constants;for(i=0;i<P.length;i=i+1){P[i].setEnabled(false);}p.service.getContainer("sap.ushell.MilkshakeFavorites",{keyCategory:c.keyCategory.FIXED_KEY,clientStorageAllowed:true,writeFrequency:c.writeFrequency.LOW,validity:0},t.getMyComponent()).done(function(C){P=t.getView()&&t.getView().byId("PanelMilkshakeFavorites")&&t.getView().byId("PanelMilkshakeFavorites").getContent();if(!P){L.error("View or control aPanelMilkshakeFavorites no longer present");return;}t.oMilkshakeContainer=C;for(i=0;i<P.length;i=i+1){if(P[i]instanceof sap.m.CheckBox){P[i].setSelected(t.oMilkshakeContainer.getItemValue(String(i))||false);}P[i].setEnabled(true);}});});},applyExistingFruitFavorites:function(i){var t=this;this.oPersonalizationPromise.then(function(p){p.personalizer.getPersData().done(t.onFruitFavoritesRead.bind(t)).fail(function(){L.error("Reading personalization data failed");});});},onFruitFavoritesRead:function(c){if(!c){return;}for(var i=0;i<c.length;i=i+1){this.getView().byId("PanelFruitFavorites").getContent()[i].setSelected(c[i]);}},onSaveFruitFavorites:function(){var c=[],i,p=this._getNestedControl("PanelFruitFavorites","sap.m.CheckBox");for(i=0;i<p.length;i=i+1){c[i]=p[i].getSelected();}this.oPersonalizationPromise.then(function(P){P.personalizer.setPersData(c);});},onSaveIceCreamFavorites:function(){var p=this._getNestedControl("PanelIceCreamFavorites","sap.m.CheckBox");for(var i=0;i<p.length;i=i+1){var s=p[i].getSelected();this.oIceCreamContainer.setItemValue(String(i),s);}this.oIceCreamContainer.save().then(function(){M.show("Ice cream personalization was saved");},function(e){M.show("Error!");L.error("An error occurred while deleting ice cream personalization",e);});},onMilkshakeChanged:function(){var p=this.getView().byId("PanelMilkshakeFavorites").getContent(),i;for(i=0;i<p.length;i=i+1){if(p[i]instanceof sap.m.CheckBox){this.oMilkshakeContainer.setItemValue(String(i),p[i].getSelected());}}this.oMilkshakeContainer.save();},onDeleteFruitPersonalization:function(){this.oPersonalizationPromise.then(function(p){p.personalizer.delPersData().then(function(){M.show("Fruit Personalization was deleted");this._deselectAllCheckboxes("PanelFruitFavorites");}.bind(this),function(e){M.show("Error!");L.error("An error occurred while deleting fruit personalization",e);});}.bind(this));},onDeleteIceCreamPersonalization:function(){this.oIceCreamContainer.getItemKeys().forEach(function(p){this.oIceCreamContainer.delItem(p);}.bind(this));this.oIceCreamContainer.save().then(function(){M.show("Ice cream personalization was deleted");this._deselectAllCheckboxes("PanelIceCreamFavorites");}.bind(this),function(e){M.show("Error!");L.error("An error occurred while deleting ice cream personalization",e);});},onDestroy:function(){this.oMilkshakeContainer.save();},_deselectAllCheckboxes:function(p){this._getNestedControl(p,"sap.m.CheckBox").forEach(function(c){c.setSelected(false);});},_getNestedControl:function(p,t){return this.getView().byId(p).getContent().filter(function(c){return c.isA(t);});}});});
/* the subsequent text seems not to contain a copyright or license statement */
sap.ui.predefine('sap/ushell/demo/AppPersSample/Component',["sap/ui/core/UIComponent"],function(U){"use strict";return U.extend("sap.ushell.demo.AppPersSample.Component",{oMainView:null,metadata:{manifest:"json"},createContent:function(){this.oMainView=sap.ui.xmlview("sap.ushell.demo.AppPersSample.App");return this.oMainView;}});});
sap.ui.require.preload({
	"sap/ushell/demo/AppPersSample/App.view.xml":'<core:View xmlns="sap.m" xmlns:core="sap.ui.core" controllerName="sap.ushell.demo.AppPersSample.App"><VBox><Panel headerText="Sample Application for Personalization"><Panel headerText="Favorites List of Fruit (Client Side HTTP Caching)" id="PanelFruitFavorites"><CheckBox text="Apple" id="checkFavorites0"/><CheckBox text="Banana" id="checkFavorites1"/><CheckBox text="Peach" id="checkFavorites2"/><CheckBox text="Orange" id="checkFavorites3"/><CheckBox text="Strawberry" id="checkFavorites4"/><Button text="Save Fruit Favorites" press=".onSaveFruitFavorites"/><Button class="sapUiTinyMarginBegin" text="Delete Stored Fruit Data" id="btnDeleteFruit" press=".onDeleteFruitPersonalization"/></Panel><Panel headerText="Favorites List of Ice cream (validity 2min)" id="PanelIceCreamFavorites"><CheckBox text="Apple" id="checkIceCreamShakeFavorites0"/><CheckBox text="Banana" id="checkIceCreamFavorites1"/><CheckBox text="Peach" id="checkIceCreamFavorites2"/><CheckBox text="Orange" id="checkIceCreamFavorites3"/><CheckBox text="Strawberry" id="checkIceCreamFavorites4"/><Button text="Save Ice cream Favorites" id="btnSaveIceCream" press=".onSaveIceCreamFavorites"/><Button class="sapUiTinyMarginBegin" text="Delete Stored Ice cream Data" id="btnDeleteIceCream" press=".onDeleteIceCreamPersonalization"/></Panel><Panel headerText="Favorites List of Milkshakes (validity 0 [FLP Window content], saved on change)" id="PanelMilkshakeFavorites" title="axxx" headertooltip="abc"><CheckBox text="Apple" id="checkMilkshakeFavorites0" select="onMilkshakeChanged"/><CheckBox text="Banana" id="checkMilkshakeFavorites1" select="onMilkshakeChanged"/><CheckBox text="Peach" id="checkMilkshakeFavorites2" select="onMilkshakeChanged"/><CheckBox text="Orange" id="checkMilkshakeFavorites3" select="onMilkshakeChanged"/><CheckBox text="Strawberry" id="checkMilkshakeFavorites4" select="onMilkshakeChanged"/></Panel></Panel></VBox></core:View>',
	"sap/ushell/demo/AppPersSample/i18n/i18n.properties":'#\n#Mon Mar 29 18:19:17 UTC 2021\nsubtitle=set favourites\ndescription=Sample app for testing the personalization ushell service\ntitle=App Personalization Sample 1\n',
	"sap/ushell/demo/AppPersSample/manifest.json":'{"_version":"1.21.0","sap.app":{"_version":"1.1.0","id":"sap.ushell.demo.AppPersSample","type":"application","i18n":{"bundleUrl":"i18n/i18n.properties","supportedLocales":[""],"fallbackLocale":""},"title":"{{title}}","subTitle":"{{subtitle}}","description":"{{description}}","applicationVersion":{"version":"1.1.0"},"ach":"CA-UI2-INT-FE","dataSources":{},"cdsViews":[],"offline":true,"crossNavigation":{"inbounds":{"inb":{"semanticObject":"Action","action":"toappperssample","signature":{"parameters":{},"additionalParameters":"allowed"}}}}},"sap.ui":{"_version":"1.1.0","technology":"UI5","icons":{"icon":"sap-icon://undefined/favorite"},"deviceTypes":{"desktop":true,"tablet":true,"phone":true},"supportedThemes":["sap_hcb","sap_bluecrystal"],"fullWidth":false},"sap.ui5":{"_version":"1.1.0","resources":{"js":[],"css":[{"uri":"css/custom.css","id":"sap.ushell.demo.AppPersSample.stylesheet"}]},"dependencies":{"minUI5Version":"1.28","libs":{"sap.m":{"minVersion":"1.28"}}},"models":{},"rootView":"","handleValidation":false,"config":{},"routing":{},"contentDensities":{"compact":false,"cozy":true},"services":{"Personalization":{"factoryName":"sap.ushell.ui5service.Personalization"}}}}'
},"sap/ushell/demo/AppPersSample/Component-preload"
);
//# sourceMappingURL=Component-preload.js.map